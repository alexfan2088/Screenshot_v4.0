<Window x:Class="Screenshot_v3_0.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="智能截屏 v3.0" Height="36"
        Topmost="True"
        ResizeMode="CanResize"
        WindowStyle="None"
        AllowsTransparency="True"
        Background="Transparent"
        WindowStartupLocation="Manual">
  <Border CornerRadius="8" Background="#0F5132" BorderBrush="#1B4332" BorderThickness="1">
    <Border.Effect>
      <DropShadowEffect Color="#40000000" BlurRadius="8" ShadowDepth="2" Opacity="0.3"/>
    </Border.Effect>
    <Grid Margin="8,4">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="Auto"/>
      </Grid.ColumnDefinitions>

      <!-- 菜单栏 -->
      <Menu Grid.Column="0" VerticalAlignment="Center" Margin="0,0,8,0" Background="Transparent">
        <Menu.Resources>
          <Style TargetType="MenuItem">
            <Setter Property="Foreground" Value="Black"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property
              ="FontSize" Value="12"/>
            <Style.Triggers>
              <Trigger Property="IsMouseOver" Value="True">
                <Setter Property="Background" Value="#E0E0E0"/>
              </Trigger>
            </Style.Triggers>
          </Style>
        </Menu.Resources>
        <MenuItem Header="设置">
          <MenuItem Header="参数配置" Click="MenuSettings_Click"/>
          <Separator/>
          <MenuItem Header="截图" x:Name="MenuScreenshot" IsCheckable="True" IsChecked="True" Click="MenuScreenshot_Click"/>
          <MenuItem Header="生成PPT" x:Name="MenuGeneratePPT" IsCheckable="True" IsChecked="True" Click="MenuGeneratePPT_Click"/>
          <MenuItem Header="生成PDF" x:Name="MenuGeneratePDF" IsCheckable="True" IsChecked="False" Click="MenuGeneratePDF_Click"/>
          <Separator/>
          <MenuItem Header="日志设置">
            <MenuItem Header="输出日志" x:Name="MenuLogEnabled" IsCheckable="True" IsChecked="True" Click="MenuLogEnabled_Click"/>
            <MenuItem Header="不输出日志" x:Name="MenuLogDisabled" IsCheckable="True" IsChecked="False" Click="MenuLogDisabled_Click"/>
            <Separator/>
            <MenuItem Header="日志文件覆盖" x:Name="MenuLogFileOverwrite" IsCheckable="True" IsChecked="True" Click="MenuLogFileOverwrite_Click"/>
            <MenuItem Header="日志文件叠加" x:Name="MenuLogFileAppend" IsCheckable="True" IsChecked="False" Click="MenuLogFileAppend_Click"/>
          </MenuItem>
        </MenuItem>
      </Menu>

      <!-- 视频录制按钮组和设置（中间部分） -->
      <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center" HorizontalAlignment="Left">
        <Button Content="开始" Width="35" Height="22" Margin="0,0,4,0" 
                Click="BtnStartVideo_Click" x:Name="BtnStartVideo" FontSize="12" Padding="2,1" ToolTip="开始录制视频"
                BorderBrush="#333333" BorderThickness="1" Cursor="Hand" IsEnabled="False">
            <Button.Style>
                <Style TargetType="Button">
                    <Setter Property="Background" Value="#000000"/>
                    <Setter Property="Foreground" Value="#999999"/>
                    <Setter Property="BorderBrush" Value="#333333"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" 
                                        BorderBrush="{TemplateBinding BorderBrush}" 
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        CornerRadius="2">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"
                                                      Content="{TemplateBinding Content}"
                                                      ContentTemplate="{TemplateBinding ContentTemplate}"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Background" Value="#000000"/>
                            <Setter Property="Foreground" Value="#999999"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="True">
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#1A1A1A"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="#000000"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>
        <Button Content="停止" Width="35" Height="22" Margin="0,0,4,0"
                Click="BtnStopVideo_Click" x:Name="BtnStopVideo" IsEnabled="False" FontSize="12" Padding="2,1" ToolTip="停止录制视频"
                BorderBrush="#333333" BorderThickness="1">
            <Button.Style>
                <Style TargetType="Button">
                    <Setter Property="Background" Value="#000000"/>
                    <Setter Property="Foreground" Value="#999999"/>
                    <Setter Property="BorderBrush" Value="#333333"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" 
                                        BorderBrush="{TemplateBinding BorderBrush}" 
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        CornerRadius="2">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"
                                                      Content="{TemplateBinding Content}"
                                                      ContentTemplate="{TemplateBinding ContentTemplate}"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Background" Value="#000000"/>
                            <Setter Property="Foreground" Value="#999999"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="True">
                            <Setter Property="Background" Value="#000000"/>
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>
        <Button Content="选择" Width="32" Height="22" Margin="0,0,4,0"
                Click="BtnSelectRegion_Click" x:Name="BtnSelectRegion" FontSize="12" Padding="2,1" ToolTip="选择录制区域"
                BorderBrush="#333333" BorderThickness="1" Cursor="Hand">
            <Button.Style>
                <Style TargetType="Button">
                    <Setter Property="Background" Value="#000000"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="BorderBrush" Value="#333333"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" 
                                        BorderBrush="{TemplateBinding BorderBrush}" 
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        CornerRadius="2">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"
                                                      Content="{TemplateBinding Content}"
                                                      ContentTemplate="{TemplateBinding ContentTemplate}"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Background" Value="#000000"/>
                            <Setter Property="Foreground" Value="#999999"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="True">
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#1A1A1A"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="#000000"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>
        <Button Content="恢复" Width="32" Height="22" Margin="0,0,8,0"
                Click="BtnRestoreRegion_Click" x:Name="BtnRestoreRegion" FontSize="12" Padding="2,1" ToolTip="恢复最近一次框选的区域"
                BorderBrush="#333333" BorderThickness="1" Cursor="Hand">
            <Button.Style>
                <Style TargetType="Button">
                    <Setter Property="Background" Value="#000000"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="BorderBrush" Value="#333333"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" 
                                        BorderBrush="{TemplateBinding BorderBrush}" 
                                        BorderThickness="{TemplateBinding BorderThickness}"
                                        CornerRadius="2">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"
                                                      Content="{TemplateBinding Content}"
                                                      ContentTemplate="{TemplateBinding ContentTemplate}"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                    <Style.Triggers>
                        <Trigger Property="IsEnabled" Value="False">
                            <Setter Property="Background" Value="#000000"/>
                            <Setter Property="Foreground" Value="#999999"/>
                        </Trigger>
                        <Trigger Property="IsEnabled" Value="True">
                            <Setter Property="Foreground" Value="White"/>
                        </Trigger>
                        <Trigger Property="IsMouseOver" Value="True">
                            <Setter Property="Background" Value="#1A1A1A"/>
                        </Trigger>
                        <Trigger Property="IsPressed" Value="True">
                            <Setter Property="Background" Value="#000000"/>
                        </Trigger>
                    </Style.Triggers>
                </Style>
            </Button.Style>
        </Button>
        
        <!-- 屏幕变化率设置 -->
        <TextBlock Text="变化率:" VerticalAlignment="Center" FontSize="12" Margin="0,0,2,0" Foreground="#D8F3DC"/>
        <TextBox x:Name="TxtScreenChangeRate" Width="50" Height="20" FontSize="12" 
                 VerticalAlignment="Center" VerticalContentAlignment="Center" 
                 TextAlignment="Center" Margin="0,0,4,0" 
                 TextChanged="TxtScreenChangeRate_TextChanged" 
                 ToolTip="屏幕变化率 (1-1000%)"
                 Background="#1B4332" Foreground="White" BorderBrush="#40916C"/>
        <TextBlock Text="%" VerticalAlignment="Center" FontSize="12" Margin="0,0,8,0" Foreground="#D8F3DC"/>
        
        <!-- 截图间隔设置 -->
        <TextBlock Text="间隔:" VerticalAlignment="Center" FontSize="12" Margin="0,0,2,0" Foreground="#D8F3DC"/>
        <TextBox x:Name="TxtScreenshotInterval" Width="40" Height="20" FontSize="12" 
                 VerticalAlignment="Center" VerticalContentAlignment="Center" 
                 TextAlignment="Center" Margin="0,0,2,0" 
                 TextChanged="TxtScreenshotInterval_TextChanged" 
                 ToolTip="截图间隔 (1-65535秒)"
                 Background="#1B4332" Foreground="White" BorderBrush="#40916C"/>
        <TextBlock Text="秒" VerticalAlignment="Center" FontSize="12" Margin="0,0,8,0" Foreground="#D8F3DC"/>
        
        <!-- 录制时长设置 -->
        <TextBlock Text="时长:" VerticalAlignment="Center" FontSize="12" Margin="0,0,2,0" Foreground="#D8F3DC"/>
        <TextBox x:Name="TxtRecordingDuration" Width="40" Height="20" FontSize="12" 
                 VerticalAlignment="Center" VerticalContentAlignment="Center" 
                 TextAlignment="Center" Margin="0,0,2,0" 
                 TextChanged="TxtRecordingDuration_TextChanged" 
                 ToolTip="录制时长 (分钟，0=无限制)"
                 Background="#1B4332" Foreground="White" BorderBrush="#40916C"/>
        <TextBlock Text="分钟" VerticalAlignment="Center" FontSize="12" Foreground="#D8F3DC"/>
      </StackPanel>

      <!-- 信息显示和窗口控制按钮（右半部分） -->
      <StackPanel Grid.Column="2" Orientation="Horizontal" VerticalAlignment="Center" Margin="-60,0,0,0">
        <TextBlock x:Name="StatusBarInfo" FontSize="12" TextWrapping="NoWrap" VerticalAlignment="Center" Foreground="#D8F3DC" Height="20" Margin="0,0,8,0"/>
        <!-- 窗口控制按钮 -->
        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
          <Button Content="—" Width="22" Height="22" Margin="0,0,3,0" 
                  Click="BtnMinimize_Click" FontSize="12" Padding="0" 
                  Background="#1B4332" BorderThickness="1" BorderBrush="#40916C"
                  Foreground="#D8F3DC" Cursor="Hand" ToolTip="最小化">
            <Button.Style>
              <Style TargetType="Button">
                <Style.Triggers>
                  <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#52B788"/>
                  </Trigger>
                </Style.Triggers>
              </Style>
            </Button.Style>
          </Button>
          <Button Content="×" Width="22" Height="22" 
                  Click="BtnClose_Click" FontSize="12" Padding="0" 
                  Background="#1B4332" BorderThickness="1" BorderBrush="#40916C"
                  Foreground="#D8F3DC" Cursor="Hand" ToolTip="关闭">
            <Button.Style>
              <Style TargetType="Button">
                <Style.Triggers>
                  <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E74C3C"/>
                    <Setter Property="Foreground" Value="White"/>
                  </Trigger>
                </Style.Triggers>
              </Style>
            </Button.Style>
          </Button>
        </StackPanel>
      </StackPanel>
    </Grid>
  </Border>
</Window>
